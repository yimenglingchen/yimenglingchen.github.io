---

layout: post

title:  设计模式之模板方法模式

tag: 设计模式

---

# 设计模式之模板方法模式

---

## 1 模板方法模式定义

```
模板方法模式的定义：定义一个操作中的算法的骨架，而将一些步骤延迟到子类中，模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。
```

---

## 2 程序示例

定义模板方法

```java
public abstract class AbstractClass {
    /**
     * 原语操作1
     */
    public abstract void doPrimitiveOperation1();
    /**
     * 原语操作2
     */
    public abstract void doPrimitiveOperation2();

    /**
     * 模板方法，定义算法骨架
     */
    public final void templateMethod() {
        doPrimitiveOperation1();
        doPrimitiveOperation2();
    }
}
```

具体的实现类写法

```java
/**
 * 具体实现类，实现原语操作
 */
public class ConcreteClass extends AbstractClass {
    @Override
    public void doPrimitiveOperation1() {
        //具体的实现
    }

    @Override
    public void doPrimitiveOperation2() {
        //具体的实现
    }
}
```

---

## 3 模板方法模式讲解

### 3.1 模板方法模式的功能

模板方法模式的功能在于固定算法骨架，而让具体算法实现可扩展。

### 3.2 模板的写法

模板方法：就是定义算法骨架的方法。

具体的操作：再模板中直接实现某些步骤的方法。

具体的模板操作：在模板中实现某些公共功能，可以提供给子类使用，一般不是具体的算法步骤的实现，而是一些辅助的公共功能。

原语操作：就是在模板中定义的抽象操作，通常是模板方法需要调用的操作，是必须的操作，而且父类中还没有办法确定下来如何实现，需要子类来真正实现的方法。

钩子操作：在模板中定义，并提供默认实现的操作。

模板工厂：在模板方法中，如果需要得到某些对象实例的话，可以考虑通过工厂方法模式来获取，把具体的构建对象的实现延迟到子类中去。

### 3.3 模板方法模式的本质

模板方法的本质：固定算法骨架。

模板方法模式主要是通过指定模板，把算法步骤固定下来。

### 3.4 模板方法模式的优缺点

#### 3.4.1 模板方法模式的优点

实现代码复用：模板方法模式是一种实现代码复用的很好的手段，通过把子类的公共功能提炼和抽取，把公共部分放到模板中去实现。

#### 3.4.2 模板方法模式的缺点

骨架不容易升级。

### 3.5 何时采用模板方法模式

1.需要固定定义算法骨架，实现一个算法的不变的部分，并把可变的行为留给子类来实现的情况。

2.各个子类中具有公共行为，应该抽取出来，集中在一个公共类中去实现，从而避免代码重复。

3.需要控制子类扩展的情况，模板方法模式会在特定的点来调用子类的方法，这样只允许在这些点进行扩展。