---

layout: post

title:  golang学习笔记(1)

tag: go语言

---

# golang学习笔记(1)

---

## 1 工作区和GOPATH

### 1 下载go

[go语言官网](https://golang.google.cn/)

下载对应的安装包后，需要配置三个环境变量，环境变量的含义如下：

GOROOT：Go语言安装根目录的路径，也就是Go语言的安装路径

GOPATH：工作区目录的路径，是我们自己定义的工作空间

GOBIN：GO程序生成的可执行文件的路径

### 2 GOPATH

GOPATH的意义：可以简单把GOPATH理解为Go语言的工作目录，他的值可以是一个或者多个路径，每个路径（目录）都代表了一个工作空间。我们在工作空间中放置Go语言的源码文件，安装的归档文件，以及可执行文件。

#### 1 Go语言源码的组织方式

Go语言的代码包中可以包含任意个go后缀的源码文件，这些源码文件需要被声明属于同一个包。

代码包的名称一般和源码文件所在的目录同名，如果不同名，则在构建，安装的时候以代码包的名称为准。

每个代码包都有导入路径，通过import

在工作区中，代码包的路径是从src开始到包的实际存储路径的相对路径。

所以，Go语言源码的组织方式是GOPATH、工作区、src目录、代码包为主线的，前面四个依次缩小范围，go的源码文件需要放在代码包中。

#### 2 了解源码安装后的结果

源码文件通常放在src工作目录的子目录中，安装后产生的归档文件（以.a为扩展名的文件）会放进工作区的pkg目录；如果产生了可执行文件，就有可能放在工作区的bin目录中。

源码会以代码包的形式组织起来，一个代码包就是一个目录，安装某个代码包产生的归档文件和这个代码包同名。

放置它的相对目录就是该代码包的导入路径的直接父级。

归档文件的相对目录和pkg目录之间还有一层平台相关目录，平台相关目录的名称是由 build（也称“构建”）的目标操作系统、下划线和目标计算架构的代号组成的。比如，构建某个代码包时的目标操作系统是 Linux，目标计算架构是 64 位的，那么对应的平台相关目录就是 linux_amd64。

#### 3 理解构建和安装Go程序的过程

构建使用命令 go bulid,安装使用命令 go install

如果构建的是库源码文件，产生的结果文件只会存在于临时目录中。

安装操作会先执行构建，然后进行链接操作，将结果文件搬运到指定目录中。

如果安装的是库源码文件，结果文件会被搬到pkg目录中的某个子目录中。

如果安装的是命令源码文件，结果文件会被搬到bin目录，或者GOBIN指定的目录中。

---

## 2 命令源码文件

命令源码文件是程序的运行入口，是每个可独立运行的程序必须拥有的，我们可以通过构建和安装，生成与其对应的可执行文件，后者一般与该命令源码文件的直接父目录命名。

对比来看，命令源码文件类似于java中的main函数。

如果一个源码文件声明属于main包，并且包含一个无参数声明且无结果声明的main函数，那么它就是命令源码文件。

代码示例：

```go
package main

import "fmt"

func main() {
	fmt.Println("Hello, world!")
}
```

Go语言有个专门用于接收和解析命令参数的代码包，flag包。

我们在调用flag包的一些函数，比如StringVar，Parse等，实际上是在调用flag.CommandLine方法。

## 3 库源码文件

库源码文件是不能被直接运行的源码文件，它仅用于存放程序实体，这些程序实体可以被其他代码使用。

在同一个目录下的源码文件都需要被声明为属于同一个代码包。

如果该目录下有一个命令源码文件，其他源码文件也要声明属于main包。



