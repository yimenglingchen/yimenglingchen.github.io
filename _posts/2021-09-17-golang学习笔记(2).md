---

layout: post

title:  golang学习笔记(2)

tag: go语言

---

# golang学习笔记(2)

---

## 1 程序实体

### 1 变量

Go语言中的程序实体包括常量，变量，函数，结构体和接口。

Go语言是静态类型的编程语言。

也就是说，在声明的时候，就需要将类型给到变量，变量也可以在定义的时候根据赋值来推导类型，而定义后，类型就不可以更改了。

变量的类型可以是预定义的类型，也可以是程序自定义的函数、结构体和接口。常量的类型不多，只能是Go语言预定义的这些类型。

声明变量的几种方式：

1.直接赋值

```go
var name = flag.String("name", "everyone", "The greeting object.")
```

2.短变量声明

```go
name := flag.String("name", "everyone", "The greeting object.")
```

通过这种方式赋值，不需要事先设定变量的类型，而是通过返回结果进行推断。

短变量声明则是Go语言在赋值时候的一个语法糖。需要注意，短变量声明只能在函数体内部使用，代表一些临时的变量。

Go语言的类型推断最大的好处是便于代码重构，提升程序灵活性。

变量重声明：

1.因为变量的类型是在初始化的时候已经确定了，因此对它再次声明时赋予的类型必须与原类型相同，否则会产生编译错误。

2.变量重声明只存在于代码块中。

3.变量的重声明只有在短变量声明的时候才能发生，否则无法通过编译。

4.被声明并赋值的变量必须是多个，并且其中至少有一个是新的变量，这种场景才可以说是对旧变量进行了重声明。

变量重声明可以直接理解为赋值。

在使用短变量声明的时候，你可能想要同时对一个已有的变量赋值，类似使用 `=` 进行多重赋值那样（如 `i, j = 2, 3`）。所以，Go 为短声明语法提供了一个语法糖（或者叫便利措施）：短变量声明不需要声明所有在左边的变量。如果多个变量在同一个词法块中声明，那么对于这些变量，短声明的行为等同于*赋值*。

一个程序实体的作用域总是会被限制在某个代码块中，而这个作用域最大的用处，就是对程序实体的访问权限的控制。

代码引用变量的时候总会优先查找当前代码块中的变量。

如果当前代码块中找不到，则根据代码块的层级，一层一层往外找，直到找到为止。

如果找到当前代码包的代码块都没能找到，程序编译就会报错了。

但如果代码包导入语句写成`import ."XXX"`,例如`import .fmt`的格式，那么就会让这个代码包中被公开的程序实体，被当前源码文件中的代码识别到。

### 2 类型断言

类型断言代码表达式示例：

```go
value, ok := interface{}(container).([]string)
```

它包括了用来把container变量的值转换为空接口值的interface{}(container),以及一个用于判断前者的类型是否为切片类型 []string 的 .([]string)。

这个表达式的结果可以赋给两个变量，ok代表断言判断的结果，如果有值，会将值赋给value，否则赋nil(空)。

这种异常在运行时叫做panic。

类型断言表达式的语法形式是x.(T)。

其中的x代表要被判断类型的值。这个值当下类型必须是接口类型。

一对不包任何东西的花括号{}，除了可以代表空的代码块外，还可以用于表示不包含任何内容的数据结构。

### 3 类型转换表达式

类型转换表达式的基本写法：T(x)

对于整数类型值、常量之间的转换，原则上只要源值在可表示范围内就是合法的。

当整数值的类型的有效范围由宽变窄时，只需在补码形式下截掉一定数量的高位二进制数即可。

虽然直接把一个整数值转换为一个string类型的值是可行的，但值得关注的是，被转换的整数值应该可以代表一个有效的 Unicode 代码点，否则转换的结果将会是"�"（仅由高亮的问号组成的字符串值）。

一个值在从string类型向[]byte类型转换时代表着UTF-8的编码的字符串会被拆分成零散独立的字节。

### 4 别名类型

可以用关键字type声明自定义的各种类型。

代码示例：

```go
type NyString = string
```

别名类型和源类型的区别只在名称上。

源类型和别名类型是一对相对的称呼，别名类型主要是为了代码重构存在的。

如果不带等号，像下面这样声明：

```go
type MyString string
```

MyString和string就是两个完全不同的类型了,这种方式也叫对类型的再定义。

此时，string可以说时MyString的潜在类型。

潜在类型相同的不同类型之间的值是可以相互转换的，但是，不可以做判等和比较，变量之间也不能赋值。

