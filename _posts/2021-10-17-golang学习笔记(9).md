---

layout: post

title:  golang学习笔记(9)

tag: go语言

---

# golang学习笔记(9)

---

## 1 测试

Go中的测试包括功能测试，性能测试和示例测试，测试的代码文件必须以被测试的源码文件为主导，以_test为后缀。

对于功能测试函数来说，其名称必须以Test为前缀，并且参数列表中只应有一个*testing.T类型的参数声明。

对于性能测试函数来说，其名称必须以Benchmark为前缀，并且参数列表中只应有一个*testing.B类型的参数声明。

对于示例测试函数来说，其名称必须以Example为前缀，但对函数的参数列表没有强制规定。

功能测试一般为并行执行，而性能测试为串行执行。

关于性能测试的解析，这里用一张郝林老师的解析图：

![alt 性能测试内容解析](/images/posts/golang学习笔记/9-1.png)

性能测试中的 -cpu 参数指的是Go在进行性能测试时，同时并发的逻辑cpu个数，这个cpu和前面的processor基本等同。

这个参数可以是一个正整数列表，用逗号进行分隔，在执行的时候，根据顺序依次执行，将每个参数的结果都打印出来进行对比。

以1,2,4为例，go test命令会先以1,2,4为最大 P 数量分别去执行第一个测试函数，之后再用同样的方式执行第二个测试函数，以此类推。

如果这个参数不加的话，就表示用默认值，这个默认值是计算机的实际cpu数量值，也就是所谓的“核”。

性能测试的执行次数如下:

`
性能测试函数的执行次数 = `-cpu`标记的值中正整数的个数 x `-count`标记的值 x 探索式执行中测试函数的实际执行次数`

功能测试不需要进行实际执行数，其余的均一致。

-parallel的作用：设置同一个被测代码包中的功能测试函数的最大并发执行数。

因为性能测试的单个函数包本来就是串行的，因此这个参数对性能测试是没有用的